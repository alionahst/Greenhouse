---
title: "Saving graphs"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```



```{r, include=FALSE}
knitr::opts_chunk$set(suffix = ".png", fig.path = "graphs/", res = 100)
#knitr options to save all the graphics in the folder “results” in png format with a resolution of 100 dpi.
```


## Changes of parameters in time 

```{r}
library("readxl")
Data <- read_excel("210129_Greenhouse_results.xlsx")
Data <- Data[-12]

if (!dir.exists("Graphs")) dir.create("Graphs")

d <- rep("06/11/20", 6)
d <- c(d, rep("11/11/20", 6))
d <- c(d, rep("18/11/20", 6))
d <- c(d, rep("30/11/20", 6))
d <- c(d, rep("14/12/20", 6))
new_date <- rep(d,8)
Data$Date2 <- new_date

Data$Date2 <- as.Date(Data$Date2, format='%d/%m/%y')

library(ggplot2)

```

```{r Leaf number change}
# Leaf number
ggplot(Data[Data$Species =="Avena",], aes(x=Date2, y = Leaf_number, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of leaf number in A. fatua", y="Leaf number", x="Date") + theme(plot.title = element_text(hjust = 0.5))
ggplot(Data[Data$Species =="Triticum",], aes(x=Date2, y = Leaf_number, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of leaf number in T. aestivum", y="Leaf number", x="Date") + theme(plot.title = element_text(hjust = 0.5))

ggplot(Data, aes(x=Date2, y = Leaf_number, color = Treatment,  linetype = Species, na.rm=TRUE )) + geom_smooth(se=F) + labs(title="Comparison of leaf number change between A. fatua and T. aestivum", y="Leaf number", x="Date") + theme(plot.title = element_text(hjust = 0.5))

```

```{r Stem length change}
ggplot(Data[Data$Species =="Avena",], aes(x=Date2, y = Stem_length, color = Treatment, na.rm=TRUE )) + geom_smooth()  + labs(title="Change of stem length in A. fatua", y="Stem length (cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5))
ggplot(Data[Data$Species =="Triticum",], aes(x=Date2, y = Stem_length, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of stem length in T. aestivum", y="Stem length (cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5))

ggplot(Data, aes(x=Date2, y = Stem_length, color = Treatment,  linetype = Species, na.rm=TRUE )) + geom_smooth(se=F) + labs(title="Comparison of stem length change between A. fatua and T. aestivum", y="stem length (cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5)) 
```

```{r RH change}
ggplot(Data[Data$Species =="Avena",], aes(x=Date2, y = RH, color = Treatment, na.rm=TRUE )) + geom_smooth()  + labs(title="Change of relative humidity in A. fatua", y="Relative humidity (%)", x="Date") + theme(plot.title = element_text(hjust = 0.5))
# Test statistical difference between 100mM and control for RH. 
ggplot(Data[Data$Species =="Triticum",], aes(x=Date2, y = RH, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of relative humidity in T. aestivum", y="Relative humidity (%)", x="Date") + theme(plot.title = element_text(hjust = 0.5))

ggplot(Data, aes(x=Date2, y = RH, color = Treatment,  linetype = Species, na.rm=TRUE )) + geom_smooth(se=F) + labs(title="Comparison of relative humidity change between A. fatua and T. aestivum", y="Relative humidity (%)", x="Date") + theme(plot.title = element_text(hjust = 0.5))
```


```{r EC change}

ggplot(Data[Data$Species =="Avena",], aes(x=Date2, y = EC, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of EC number in A. fatua", y="EC (mS/cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5))
ggplot(Data[Data$Species =="Triticum",], aes(x=Date2, y = EC, color = Treatment, na.rm=TRUE )) + geom_smooth() + labs(title="Change of EC number in T. aestivum", y="EC(mS/cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5))

ggplot(Data, aes(x=Date2, y = EC, color = Treatment,  linetype = Species, na.rm=TRUE )) + geom_smooth(se=F) + labs(title="Comparison of EC change between A. fatua and T. aestivum", y="EC (mS/cm)", x="Date") + theme(plot.title = element_text(hjust = 0.5))


```




# Comparison of parameters and treatments *within* species 

```{r}
library(ggplot2)
library(dplyr)
library(ggpubr)
#Dataframe with only the last day
Data.last <- Data[Data$Date =="201214" , ]

Data.last$Treatment <- as.factor(Data.last$Treatment)
Data.last$Stem_length <- as.numeric(Data.last$Stem_length)
#Treatment2 created to reorder the variables in the graph
Data.last$Treatment2 <- factor(Data.last$Treatment, c("Control", "100", "200", "Drought"))
```


```{r stem lenght within species}
#Stem length graph
Data.last$Stem_length <- as.numeric(Data.last$Stem_length)
StemGraphA<- ggplot(Data.last[Data.last$Species == "Avena" ,], aes(x = Treatment2 , y = Stem_length))
StemGraphA<- StemGraphA +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= "Stem length (cm)", x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Avena")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=70, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=70, label="ab", cex= 6, color="black")+
  annotate(geom="text", x=3, y=70, label="b", cex= 6, color="black")+
  annotate(geom="text", x=4, y=70, label="c", cex= 6, color="black")

StemGraphT<- ggplot(Data.last[Data.last$Species == "Triticum" ,], aes(x = Treatment2 , y = Stem_length))
StemGraphT<- StemGraphT +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= NULL, x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Triticum")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=70, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=70, label="a", cex= 6, color="black")+
  annotate(geom="text", x=3, y=70, label="b", cex= 6, color="black")+
  annotate(geom="text", x=4, y=70, label="b", cex= 6, color="black")

StemGraph <- ggarrange(
  StemGraphA, NULL,  StemGraphT,
  nrow = 1, widths = c(1, -0.035, 1),
  labels = c("", "", ""))

StemGraph <-   annotate_figure(StemGraph,
                               top = text_grob("Stem length under different treatments", face = "bold", size = 14)) 
StemGraph
```

```{r leaf number within species}
#Leaf number graph
Data.last$Leaf_number <- as.numeric(Data.last$Leaf_number)
LeafGraphA<- ggplot(Data.last[Data.last$Species == "Avena" ,], aes(x = Treatment2 , y = Leaf_number))
LeafGraphA<- LeafGraphA +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= "Leaves number", x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Avena")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=3, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=4, y=10, label="b", cex= 6, color="black")


LeafGraphT<- ggplot(Data.last[Data.last$Species == "Triticum" ,], aes(x = Treatment2 , y = Leaf_number))
LeafGraphT<- LeafGraphT +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= NULL, x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Triticum")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=3, y=10, label="b", cex= 6, color="black")+
  annotate(geom="text", x=4, y=10, label="c", cex= 6, color="black")


LeafGraph <- ggarrange(
  LeafGraphA, NULL,  LeafGraphT,
  nrow = 1, widths = c(1, -0.035, 1),
  labels = c("", "", "")
)
LeafGraph <-   annotate_figure(LeafGraph,
                top = text_grob("Leaf number", face = "bold", size = 14)) 
LeafGraph
```

```{r root length within species}
#Root length graph
Data.last$Root_Length <- as.numeric(Data.last$Root_Length)
RootGraphA<- ggplot(Data.last[Data.last$Species == "Avena" ,], aes(x = Treatment2 , y = Root_Length))
RootGraphA<- RootGraphA +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= "Root length (cm)", x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Avena")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=30, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=30, label="a", cex= 6, color="black")+
  annotate(geom="text", x=3, y=30, label="a", cex= 6, color="black")+
  annotate(geom="text", x=4, y=30, label="a", cex= 6, color="black")


RootGraphT<- ggplot(Data.last[Data.last$Species == "Triticum" ,], aes(x = Treatment2 , y = Root_Length))
RootGraphT<- RootGraphT +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= NULL, x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Triticum")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=40, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=40, label="a", cex= 6, color="black")+
  annotate(geom="text", x=3, y=40, label="a", cex= 6, color="black")+
  annotate(geom="text", x=4, y=40, label="a", cex= 6, color="black")


RootGraph <- ggarrange(
  RootGraphA, NULL,  RootGraphT,
  nrow = 1, widths = c(1, -0.035, 1),
  labels = c("", "", "")
)
RootGraph <-   annotate_figure(RootGraph,
                               top = text_grob("Root length under different treatments", face = "bold", size = 14)) 
RootGraph
```

```{r fresh weight within species}
#Fresh weight graph 
Data.last$Fresh_weight <- as.numeric(Data.last$Fresh_weight)
FreshGraphA<- ggplot(Data.last[Data.last$Species == "Avena" ,], aes(x = Treatment2 , y = Fresh_weight))
FreshGraphA<- FreshGraphA +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= "Fresh weight (g)", x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Avena")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=10, label="ab", cex= 6, color="black")+
  annotate(geom="text", x=3, y=10, label="bc", cex= 6, color="black")+
  annotate(geom="text", x=4, y=10, label="c", cex= 6, color="black")


FreshGraphT<- ggplot(Data.last[Data.last$Species == "Triticum" ,], aes(x = Treatment2 , y = Fresh_weight))
FreshGraphT<- FreshGraphT +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= NULL, x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Triticum")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=10, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=10, label="b", cex= 6, color="black")+
  annotate(geom="text", x=3, y=10, label="c", cex= 6, color="black")+
  annotate(geom="text", x=4, y=10, label="d", cex= 6, color="black")


FreshGraph <- ggarrange(
  FreshGraphA, NULL,  FreshGraphT,
  nrow = 1, widths = c(1, -0.035, 1),
  labels = c("", "", "")
)
FreshGraph <-   annotate_figure(FreshGraph,
                               top = text_grob("Fresh weight under different treatments", face = "bold", size = 14)) 
FreshGraph
```

```{r dry weight within species}
#Dry weight graph
Data.last$Dry_weight <- as.numeric(Data.last$Dry_weight)
DryGraphA<- ggplot(Data.last[Data.last$Species == "Avena" ,], aes(x = Treatment2 , y = Dry_weight))
DryGraphA<- DryGraphA +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= "Dry weight (g)", x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Avena")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=8.75, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=8.75, label="ab", cex= 6, color="black")+
  annotate(geom="text", x=3, y=8.75, label="b", cex= 6, color="black")+
  annotate(geom="text", x=4, y=8.75, label="c", cex= 6, color="black")


DryGraphT<- ggplot(Data.last[Data.last$Species == "Triticum" ,], aes(x = Treatment2 , y = Dry_weight))
DryGraphT<- DryGraphT +geom_boxplot(
  aes(fill = Treatment2),
  position = position_dodge(0.75)) +
  labs(y= NULL, x = "Treatment")+
  theme(legend.position = "none") +
  ggtitle("Triticum")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=8.75, label="a", cex= 6, color="black")+
  annotate(geom="text", x=2, y=8.75, label="b", cex= 6, color="black")+
  annotate(geom="text", x=3, y=8.75, label="c", cex= 6, color="black")+
  annotate(geom="text", x=4, y=8.75, label="d", cex= 6, color="black")


DryGraph <- ggarrange(
  DryGraphA, NULL,  DryGraphT,
  nrow = 1, widths = c(1, -0.035, 1),
  labels = c("", "", "")
)
DryGraph <-   annotate_figure(DryGraph,
                                top = text_grob("Dry weight under different treatments", face = "bold", size = 14)) 
DryGraph
```



## Comparison of parameters and treatment between species 

```{r}

Control <- Data.last[Data.last$Treatment=="Control",]
OnemM <- Data.last[Data.last$Treatment=="100",]
TwomM <- Data.last[Data.last$Treatment=="200",]
Drought <- Data.last[Data.last$Treatment=="Drought",]

```


```{r leaf number between species}
####Leaf number####
Data.last$Leaf_number <- as.numeric(Data.last$Leaf_number)
LeafGraph<- ggplot(Data.last, aes(x = Treatment2 , y = Leaf_number))
LeafGraph<- LeafGraph +geom_boxplot(
  aes(fill = Species),
  position = position_dodge(0.75)) +
  labs(y= "Leaf number", x = "Treatment")+ 
  ggtitle("Leaf number under different treatment")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=10, label="*", cex= 8.5, color="black")+
  annotate(geom="text", x=2, y=10, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=3, y=10, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=4, y=10, label="ns", cex= 7, color="black")
LeafGraph
```

```{r stem length between species}
Data.last$Stem_length <- as.numeric(Data.last$Stem_length)
StemGraph<- ggplot(Data.last, aes(x = Treatment2 , y = Stem_length))
StemGraph<- StemGraph +geom_boxplot(
  aes(fill = Species),
  position = position_dodge(0.75)) +
  labs(y= "Stem length (cm)", x = "Treatment")+ 
  ggtitle("Stem length under different treatment")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=70, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=2, y=70, label="**", cex= 8.5, color="black")+
  annotate(geom="text", x=3, y=70, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=4, y=70, label="ns", cex= 7, color="black")
StemGraph

```

```{r root length between species}
Data.last$Root_Length <- as.numeric(Data.last$Root_Length)
RootGraph<- ggplot(Data.last, aes(x = Treatment2 , y = Root_Length))
RootGraph<- RootGraph +geom_boxplot(
  aes(fill = Species),
  position = position_dodge(0.75)) +
  labs(y= "Root length (cm)", x = "Treatment")+ 
  ggtitle("Root length under different treatment")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=40, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=2, y=40, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=3, y=40, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=4, y=40, label="ns", cex= 7, color="black")
RootGraph
```

```{r dry weight between species}
Data.last$Dry_weight <- as.numeric(Data.last$Dry_weight)
DryGraph<- ggplot(Data.last, aes(x = Treatment2 , y = Dry_weight))
DryGraph<- DryGraph +geom_boxplot(
  aes(fill = Species),
  position = position_dodge(0.75)) +
  labs(y= "Dry weight (g)", x = "Treatment")+ 
  ggtitle("Dry weight under different treatment")+ 
  theme(plot.title = element_text(hjust = 0.5))+
  annotate(geom="text", x=1, y=8.5, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=2, y=8.5, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=3, y=8.5, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=4, y=8.5, label="*", cex= 8.5, color="black")
DryGraph
```

```{r fresh weight between species}
Data.last$Fresh_weight <- as.numeric(Data.last$Fresh_weight)
FreshGraph<- ggplot(Data.last, aes(x = Treatment2 , y = Fresh_weight))
FreshGraph<- FreshGraph +geom_boxplot(
  aes(fill = Species),
  position = position_dodge(0.75)) +
  labs(y= "Fresh weight (g)", x = "Treatment")+ 
  ggtitle("Fresh weight under different treatment")+ 
  theme(plot.title = element_text(hjust = 0.5)) +
  annotate(geom="text", x=1, y=10, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=2, y=10, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=3, y=10, label="ns", cex= 7, color="black")+
  annotate(geom="text", x=4, y=10, label="*", cex= 8.5, color="black")
FreshGraph
```

